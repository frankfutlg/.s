#!/bin/bash

pidcom=($(pgrep -x picom))

startgm() {
	sudo govctl -p
	nvidia-settings -a "[gpu:0]/GPUPowerMizerMode=1" >/dev/null
	[ "$pidcom" ] && kill -9 "$pidcom" || exit 0 
}

stopgm() {
	sudo govctl -s
	nvidia-settings -a "[gpu:0]/GPUPowerMizerMode=0" >/dev/null
	[ "$pidcom" ] || setsid -f picom >/dev/null &
}

case $1 in
	--start) startgm ;;
	--stop) stopgm ;;
	*) echo -e "\e[31mInvalid option.\e[0m"; exit 1 ;;
esac
